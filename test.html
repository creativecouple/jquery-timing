<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<style type="text/css">
table {
	empty-cells: show;
	border-collapse: collapse;
	border: none;
	padding: 0;
	margin: 1em;
}
td, th {
	padding: 3px;
	margin: 0;
	text-align: left;
}
tr, th {
	border: 1px solid #ccc;
}
th.method {
	font-weight: normal;
	font-family: monospace;
	cursor: pointer;
}
th.method:hover {
	background: #f8f8f8;
}
th.title {
	padding: 1em;
}
th.jquery {
	text-align: center;
}
td {
	background-color: white;
	border-right: 1px solid #ccc;
}
td.result {
	width: 20px;
	height: 20px;
}
td.run {
	background: url(_tests/run.gif) no-repeat center center scroll;
	color: transparent;
}
td.ok {
	background: url(_tests/ok.png) no-repeat center center scroll;
	color: transparent;
}
td.fail {
	background: url(_tests/fail.png) no-repeat center center scroll;
	color: transparent;
}
td.error {
	background: url(_tests/error.png) no-repeat center center scroll;
	color: transparent;
}
td.x {
	background-color: #eef;
	border-right: none;
}
tr.y td {
	background-color: #fee;
}
tr.y td.x {
	background-color: #fdf;
}
h2 {
	border-bottom: 1px solid navy;
	margin: 2em 0;
}
.summary {
	color: maroon;
}
</style>
</head>
<body>

<h1>Automated Tests for <em>jquery-timing.js</em> and <em>jquery-timing.min.js</em><br/><small>against jQuery 1.2, 1.3, 1.4, 1.5, 1.6, 1.7</small></h1>

<script type="text/javascript">
var jQueries = {};
function savejQuery(type) {
	var version = $().jquery;
	jQueries[version] = jQueries[version] || {};
	jQueries[version][type] = jQuery.noConflict(); 
}
</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.2/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.2/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.js')</script>
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>
<script type="text/javascript">savejQuery('jquery-timing.min.js')</script>

<h1 class="summary"></h1>
<h1 class="summary"></h1>

<p><button onclick="window.location.reload()">Run tests again&hellip;</button></p>

<script type="text/javascript">var tests = {}, minVersion={};</script>
<script charset="utf-8" type="text/javascript" src="_tests/test.wait.js"></script>
<script type="text/javascript">tests[".wait() functionality"] = suite;</script>
<script charset="utf-8" type="text/javascript" src="_tests/test.repeat.js"></script>
<script type="text/javascript">tests[".repeat() functionality"] = suite;</script>
<script charset="utf-8" type="text/javascript" src="_tests/test.join.js"></script>
<script type="text/javascript">tests[".join() functionality"] = suite; minVersion[".join() functionality"]='1.4.0'</script>
<script charset="utf-8" type="text/javascript" src="_tests/test.var.js"></script>
<script type="text/javascript">tests["$$() functionality"] = suite; minVersion["$$() functionality"]='1.4.0'</script>

<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="jquery-timing.min.js"></script>

<script type="text/javascript">
var assertionException = new Error("assertion violated");
function TestCase(success, error) {
	this.finished = false;
	this.check = function(){
		if (this.finished) {
			throw assertionException;
		} 
	};
	this.done = function() {
		if (this.finished) {
			throw assertionException;
		} 
		this.finished = true;
		success();
	};
	this.fail = function(message) {
		if (this.finished) {
			throw assertionException;
		}
		this.finished = true;
		error(message);
		throw assertionException;
	};
	this.assert = function(msg, condition){
		if (!condition) {
			this.fail(msg);
		}
	};
	this.assertTrue = this.assert;
	this.assertFalse = function(msg, condition) {
		this.assert(msg, !condition);
	};
	this.assertEquals = function(msg, expected, value) {
		if (expected != value) {
			this.fail(msg+'\n'+expected+' != '+value+'');
		}
	};
}
var count=0;
var passed=0;
var fails=0;
var errors=0;
$(document).ready(function(){
	var $summary = $('.summary');
	
	function updateResults() {
		var still = count-passed-fails-errors;
		$summary.html('tests: '+count+'; passed:'+passed+'; failures:'+fails+'; errors:'+errors+'; still running:'+((still > 0) ? still+'&hellip;' : still));
	}
	
	$.each(tests, function(part, suite){
		var $headline = $('<h2>').text(part).insertBefore($summary.last());			
		var $table = $('<table>').insertBefore($summary.last());
		
		var $tbody = $('<tbody>').appendTo($table);
		$.each(suite, function(name, testMethod){
			if (!testMethod) {
				$tbody = $('<tbody>').appendTo($table);
				var $tr = $('<tr>').append($('<th class="title">').text(name)).appendTo($tbody);
				$.each(jQueries, function(version){
					$('<th colspan="2" class="jquery">').text(version).attr('title','jQuery version '+version).appendTo($tr);
				});
			} else {
				var $tr = $('<tr>').append($('<th class="method">').text(name).click(function(){
					var wnd = window.open('about:blank','_blank');
					$(wnd.document.body).append($('<h1>').text(part)).append($('<h2>').text(name)).append($('<pre>').text(testMethod.toString()));
					wnd.document.title = part + ': ' + name;
				})).appendTo($tbody);
				$.each(jQueries, function(version, types){
					$.each(types, function(type, _jQuery){
						var $td = $('<td class="result">â€¦').addClass('run').attr('title','jQuery '+version+' + '+type).appendTo($tr);
						if (minVersion[part] && (version < minVersion[part])) {
							return $td.removeClass('run').text('-');
						}
						count++;
						window.setTimeout(function(){
							var testCase = new TestCase(function(){
								$td.removeClass('run').addClass('ok').text('+');
								passed++;
								updateResults();
							}, function(message){
								$td.removeClass('run').addClass('fail').text('-').attr('title',message || 'error');
								fails++;
								updateResults();
							});
							try {
								window.setTimeout(function(){
									try {
										testCase.assertTrue(testCase.finished || !$td.addClass('error'), 'processing timeout exceeded');										
									} catch (error) {}
								}, 10000)
								testMethod(_jQuery, testCase);
							} catch(error) {
								if ((error !== assertionException) && !testCase.finished) {									
									testCase.finished = true;
									$td.removeClass('run').addClass('error').text('!').attr('title',String(error));
									errors++;
									updateResults();
									throw error;
								}
							}
						}, 500+count*3);
					});
				});
			}
		});
	});
	$summary.text(count+' tests');
	
	$('td:even').addClass('x');
	$('tr:even').addClass('y');
});
</script>
</body>
</html>